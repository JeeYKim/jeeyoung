<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN' 'http://ibatis.apache.org/dtd/sql-map-2.dtd'>

<sqlMap namespace="member">
	<!-- 데이터를 꺼낼때 사용할것 설정 -->
	<typeAlias alias="member" type="model.memberVO" />

	<!-- 리절트 맵 정의: id="memberRes" -->
	<resultMap id="memberRes" class="member">
		<result property="Member_ID" column="Member_ID" />
		<result property="Member_PW" column="Member_PW" />
		<result property="Member_NAME" column="Member_NAME" />
		<result property="Member_JUMIN1" column="Member_JUMIN1" />
		<result property="Member_JUMIN2" column="Member_JUMIN2" />
		<result property="Member_ZIPCODE" column="Member_ZIPCODE" />
		<result property="Member_ADDR1" column="Member_ADDR1" />
		<result property="Member_ADDR2" column="Member_ADDR2" />
		<result property="Member_PHONE" column="Member_PHONE" />
		<result property="Member_MOBILE" column="Member_MOBILE" />
		<result property="Member_EMAIL" column="Member_EMAIL" />
		<result property="Member_REGDATE" column="Member_REGDATE" />
		<result property="Member_ADMIN" column="Member_ADMIN" />
	</resultMap>

	<!-- 공통으로 사용할 select 절 정의 -->

	<sql id="select-all">
		SELECT * FROM MEMBER
	</sql>

	<!-- 공통으로 사용할 where-no 절 정의 -->
	<sql id="where-id">
		WHERE member_id = #Member_ID#
	</sql>


	<!-- 회원가입 -->
	<insert id="memberInsert" parameterClass="member">
		insert into member (
		member_id, member_pw, member_name, member_jumin1, member_jumin2, member_zipcode, member_addr1,
		member_addr2,
		member_phone, member_mobile, member_email,
		member_regdate,member_admin
		) values(
		#Member_ID#, #Member_PW#, #Member_NAME#,
		#Member_JUMIN1#, #Member_JUMIN2#, #Member_ZIPCODE#, #Member_ADDR1#,
		#Member_ADDR2#,
		#Member_PHONE#,
		#Member_MOBILE#, #Member_EMAIL#,
		#Member_REGDATE#,#Member_ADMIN#
		)
	</insert>
	
	<!-- 아이디 체크 -->
	<select id="searchID2" parameterClass="member" resultClass="member">
		select * from member WHERE upper(member_id) LIKE upper(#Member_ID#)
	</select>
	
	<!--  회원 삭제&데이터 삽입 -->
	<insert id="reciveData">
	insert into member_back select * from member where member_id = #Member_ID#
	</insert>
	
	<!--  회원 삭제 -->
	<delete id="deleteUser">
	delete from member where member_id = #Member_ID#
	</delete>
	
	<!--  ID찾기 -->
	<select id="idfind" parameterClass="member" resultClass="member">
	select * from member where member_name = #Member_NAME# and member_jumin1 = #Member_JUMIN1# and member_jumin2 = #Member_JUMIN2#
	</select>
	
	<!--  회원 수정 하기 위한 정보 얻기 -->
	<select id="getmodify" parameterClass="String" resultClass="member">
	select * from member where member_id = #id#
	</select>
	
	<!--  PW찾기 -->
	<select id="pwfind" parameterClass="member" resultClass="member">
	select * from member WHERE upper(member_id) LIKE '%'||upper(#Member_ID#)||'%' and member_jumin1 = #Member_JUMIN1# and member_jumin2 = #Member_JUMIN2#
	</select>
	
	<!--  회원 수정 -->
	<update id="modifyUser" parameterClass="member">
	UPDATE MEMBER SET
		member_pw = #Member_PW#,
		MEMBER_EMAIL =	#Member_EMAIL#, 
		member_zipcode = #Member_ZIPCODE#, 
		member_addr1 = #Member_ADDR1#,
		member_addr2 = #Member_ADDR2#, 
		member_phone =#Member_PHONE#,
		member_mobile = #Member_MOBILE#
		WHERE member_id = #Member_ID#
	</update>
		<!-- 회원 중복 체크 -->
	<select id="searchID" parameterClass="String" resultClass="member">
		select * from member WHERE upper(member_id) LIKE upper(#Member_ID#) 
	</select>
	
	<!--  아이디 리스트 -->
	<select id="selectAll" resultMap="memberRes">
		select * from member
		ORDER BY Member_NAME DESC
	</select>
	<!--  상세 보기 -->
	<select id="selectOne" resultMap="memberRes" parameterClass="String">
		select * from member
		WHERE upper(member_id) LIKE '%'||upper(#Member_ID#)||'%'
	</select>
	
	<!--  회원 검색 -->
	<select id="adminMem.searchId" resultMap="memberRes" parameterClass="string">
		select * from member
		 WHERE Member_ID like #searchKeyword#
		 ORDER BY Member_NAME DESC
	</select>
	
	<select id="adminMem.searchName" resultMap="memberRes" parameterClass="string">
		select * from member
		 WHERE Member_name like #searchKeyword#
		 ORDER BY Member_NAME DESC
	</select>
	
	<select id="adminMem.searchDate" resultMap="memberRes" parameterClass="string">
		select * from member
		 WHERE Member_regdate like #searchKeyword#
		 ORDER BY Member_NAME DESC
	</select>

</sqlMap>  
