<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN' 'http://ibatis.apache.org/dtd/sql-map-2.dtd'>
<sqlMap namespace="Message">

	<typeAlias alias="message" type="model.MessageVO" />

		<!-- 리절트 맵 정의 -->
	  	<resultMap id="messageRes" class="message">
	      	<result property="wrt_id" column="Member_ID"/>
		  	<result property="msg_no" column="Message_NO"/>
		  	<result property="msg_content" column="Message_CONTENT"/>
		  	<result property="rec_id" column="Member_ID_REC" />
		  	<result property="msg_regdate" column="Message_REGDATE"/>
		</resultMap>
		



		<!-- 받은 Msg 리스트 -->
		<select id="Msg-select_Rec"   resultMap="messageRes" parameterClass="String" remapResults="true" >
			select * from message WHERE member_id_Rec=#rec_id# order by Message_REGDATE desc
		</select>
		<!-- 내가 쓴 Msg 리스트 -->
		<select id="Msg-select_Wrt" resultMap="messageRes" parameterClass="String" remapResults="true">
			select * from message where member_id = #wrt_id# order by Message_NO desc
		</select>
		<!-- Msg 리스트 개수 -->
		<select id="Msg_Count" parameterClass="int">
			select count(*) from message
		</select>
		<!-- Msg 쓰기 -->
		<insert id="WriteMessage" parameterClass="message">
			insert into message (Member_ID,
			Message_NO, Message_CONTENT,
			Member_ID_REC, Message_REGDATE)
			 values(#wrt_id#,
			 MSG_NO_SEQ.NEXTVAL, #msg_content#, 
			 #rec_id#, #msg_regdate#)
		</insert>
		
		<!-- 글 하나 정보 가져오기 -->
		<select id="Msg-selectOne" resultMap="messageRes" parameterClass="int" remapResults="true">
			select * from message where Message_NO = #msg_no#
		</select>
		
	<!--  메시지 검색 -->
	<select id="Msg-selectSearchW" resultMap="messageRes" parameterClass="string">
		select * from message
		 WHERE Member_ID_REC like #searchKeyword#
		 ORDER BY Message_NO DESC
	</select>
	
	<select id="Msg-selectSearchC" resultMap="messageRes" parameterClass="string">
		select * from message
		 WHERE Message_CONTENT like #searchKeyword#
		 ORDER BY Message_NO DESC
	</select>
	
	<select id="Msg-selectSearchD" resultMap="messageRes" parameterClass="string">
		select * from message
		 WHERE Message_REGDATE like #searchKeyword#
		 ORDER BY Message_NO DESC
	</select>
		
		
		
		

</sqlMap>